(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[976],{3355:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/quote/[id]",function(){return s(6307)}])},6307:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var r=s(5893),n=s(1163),u=s(7294),a=s(3299);function i(){let e=(0,n.useRouter)(),{id:t}=e.query,[s,i]=(0,u.useState)(null),[o,l]=(0,u.useState)(""),[d,c]=(0,u.useState)(""),{data:p}=(0,a.useSession)();(0,u.useEffect)(()=>{t&&h(t)},[t]);let h=async e=>{try{let t=await fetch("http://localhost:3001/api/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:'\n            {\n              business(where: { id: "'.concat(e,'" }) {\n                name\n              }\n            }\n          ')})}),s=await t.json();i(s.data.business)}catch(e){console.error("Error fetching business details:",e)}},b=async s=>{if(s.preventDefault(),!p){e.push("/auth/signin");return}try{console.log("Submitting Quote with:",{service:o,message:d,business:t,user:p.user.id,status:"pending"});let e={service:o,message:d,businessId:t,userId:p.user.id,status:"pending"},s=await fetch("http://localhost:3001/api/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n            mutation CreateQuote($service: String!, $message: String!, $businessId: ID!, $userId: ID!, $status: String!) {\n                createQuote(data: {\n                    service: $service,\n                    message: $message,\n                    business: { connect: { id: $businessId } },\n                    user: { connect: { id: $userId } },\n                    status: $status\n                }) {\n                    id\n                }\n            }\n        ",variables:e})}),r=await s.json();s.ok&&!r.errors?(l(""),c(""),alert("Quote request submitted successfully!")):console.error("Error submitting quote:",r.errors||s.statusText)}catch(e){console.error("Error submitting quote:",e)}};return(0,r.jsxs)("div",{className:"container mx-auto mt-10 p-4",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold mb-4",children:["Request a Quote for ",s?s.name:"Loading..."]}),(0,r.jsx)("div",{className:"bg-white p-8 shadow-lg rounded-lg border-t-4 border-purple-600",children:(0,r.jsxs)("form",{onSubmit:b,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 text-lg mb-2",htmlFor:"service",children:"Service Required"}),(0,r.jsx)("input",{type:"text",id:"service",className:"w-full p-2 border rounded-md focus:border-purple-500 focus:ring-purple-500",value:o,onChange:e=>l(e.target.value),placeholder:"Specify the service you're interested in",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 text-lg mb-2",htmlFor:"message",children:"Message"}),(0,r.jsx)("textarea",{id:"message",className:"w-full p-2 border rounded-md focus:border-purple-500 focus:ring-purple-500",rows:"4",value:d,onChange:e=>c(e.target.value),placeholder:"Provide additional details about your request",required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"bg-gradient-to-r from-purple-500 to-purple-700 text-white px-6 py-2 rounded-full hover:bg-purple-800 transition duration-300",children:"Submit Quote"})]})})]})}},1163:function(e,t,s){e.exports=s(6036)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=3355)}),_N_E=e.O()}]);